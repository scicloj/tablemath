[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Tablemath",
    "section": "",
    "text": "1 Preface\nMath and stats modelling with table ergonomics\nThis project is an initial attempt to create a Clojure library for math and statistics which is friendly to tech.ml.dataset and Tablecloth datasets and uses the functionality of Fastmath. It is also intended to compose well with Tableplot layered plotting. It is highly inspired by R and its package.\nIn a way, it is intended to be a user-friendly compatiblity layer across these libraries.\nPossibly, after the details clarify, it will be merged into one of the other Scicloj libraries.\nTablemath is a Clojure library for math and statistical modeling with table ergonomics, inspired by R.\nIt composes Tablecloth datasets with Fastmath modeling.",
    "crumbs": [
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>Preface</span>"
    ]
  },
  {
    "objectID": "index.html#general-info",
    "href": "index.html#general-info",
    "title": "Tablemath",
    "section": "General info",
    "text": "General info\n\n\n\nWebsite\nhttps://scicloj.github.io/tablemath/\n\n\nSource\n\n\n\nDeps\n\n\n\nLicense\nEPLv2.0\n\n\nStatus\nðŸ› experimentalðŸ› ",
    "crumbs": [
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>Preface</span>"
    ]
  },
  {
    "objectID": "index.html#chapters-in-this-book",
    "href": "index.html#chapters-in-this-book",
    "title": "Tablemath",
    "section": "Chapters in this book",
    "text": "Chapters in this book\n\nAPI reference\n\n\nsource: notebooks/index.clj",
    "crumbs": [
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>Preface</span>"
    ]
  },
  {
    "objectID": "tablemath_book.reference.html",
    "href": "tablemath_book.reference.html",
    "title": "2Â  API reference",
    "section": "",
    "text": "Setup\nIn this notebook, we will use Tablecloth and Tableplot for code examples, alongside Tablemath.",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>API reference</span>"
    ]
  },
  {
    "objectID": "tablemath_book.reference.html#setup",
    "href": "tablemath_book.reference.html#setup",
    "title": "2Â  API reference",
    "section": "",
    "text": "(ns tablemath-book.reference\n  (:require [scicloj.tablemath.v1.api :as tm]\n            [tablecloth.api :as tc]\n            [tablecloth.column.api :as tcc]\n            [scicloj.tableplot.v1.plotly :as plotly]\n            [tablemath-book.utils :as utils]))",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>API reference</span>"
    ]
  },
  {
    "objectID": "tablemath_book.reference.html#reference",
    "href": "tablemath_book.reference.html#reference",
    "title": "2Â  API reference",
    "section": "Reference",
    "text": "Reference\n\nwith\n[m expr]\nEvaluate expression expr in the context of destructuring all the keys of map m.\n\nExamples\n\n(tm/with {:x 3 :y 9}\n         '(+ x y))\n\n\n12\n\n\n(tm/with (tc/dataset {:x (range 4)\n                      :y 9})\n         '(tcc/+ x y))\n\n\n#tech.v3.dataset.column&lt;int64&gt;[4]\nnull\n[9, 10, 11, 12]\n\n\n\n\ncolumns-with\n[dataset specs]\nCompute a sequence of named columns by a given sequence of specs in the context of a given dataset.\nEach spec is one of the following:\n\n\na keyword or string - in that case, we just take the corresponding column of the original dataset.\n\n\na vector of two elements [nam expr], where the first is a string or a keyword. In that case, nam is interpreted as a name or a name-prefix for the resulting columns, and expr is handled as an expression as in (3).\n\n\nany other Clojure form - in that case, we treat it as an expression, and evaluate it while destructuring the column names of dataset as well as all the columns created by previous specs; the evaluation is expected to return one of the following:\n\n\na column (or the data to create a column (e.g., a vector of numbers))\na sequential of columns\na map from column names to columns\n\n\nIn any case, the result of the spec is turned into a sequence of named columns, which is conctenated to the columns from the previous specs. Some default naming mechanisms are invoked if column names are missing.\nEventually, the sequence of all resulting columns is returned.\n\nExamples\nNote the naming of the resulting columns, and note they can sequentially depend on each other.\n\n(tm/columns-with (tc/dataset {\"w\" [:A :B :C]\n                              :x (range 3)\n                              :y (reverse (range 3))})\n                 [\"w\"\n                  :x\n                  '(tcc/+ x y)\n                  [:z '(tcc/+ x y)]\n                  [:z1000 '(tcc/* z 1000)]\n                  '((juxt tcc/+ tcc/*) x y)\n                  [:p '((juxt tcc/+ tcc/*) x y)]\n                  '{:a (tcc/+ x y)\n                    :b (tcc/* x y)}\n                  [:p '{:a (tcc/+ x y)\n                        :b (tcc/* x y)}]\n                  '[(tcc/column (tcc/+ x y) {:name :c})\n                    (tcc/column (tcc/* x y) {:name :d})]\n                  [:p '[(tcc/column (tcc/+ x y) {:name :c})\n                        (tcc/column (tcc/* x y) {:name :d})]]])\n\n\n(#tech.v3.dataset.column&lt;keyword&gt;[3]\nw\n[:A, :B, :C] #tech.v3.dataset.column&lt;int64&gt;[3]\n:x\n[0, 1, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n(tcc/+ x y)\n[2, 2, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n:z\n[2, 2, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n:z1000\n[2000, 2000, 2000] #tech.v3.dataset.column&lt;int64&gt;[3]\n((juxt tcc/+ tcc/*) x y)_0\n[2, 2, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n((juxt tcc/+ tcc/*) x y)_1\n[0, 1, 0] #tech.v3.dataset.column&lt;int64&gt;[3]\n:p_0\n[2, 2, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n:p_1\n[0, 1, 0] #tech.v3.dataset.column&lt;int64&gt;[3]\n:a\n[2, 2, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n:b\n[0, 1, 0] #tech.v3.dataset.column&lt;int64&gt;[3]\n:pa\n[2, 2, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n:pb\n[0, 1, 0] #tech.v3.dataset.column&lt;int64&gt;[3]\n:c\n[2, 2, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n:d\n[0, 1, 0] #tech.v3.dataset.column&lt;int64&gt;[3]\n:pc\n[2, 2, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n:pd\n[0, 1, 0])\n\n\n\n\ndesign\n[dataset target-specs feature-specs]\nGiven a dataset and sequences target-specs, feature-specs, generate a new dataset from the columns generated by columns-with from these two sequences. The columns from target-specs will be marked as targets for modelling (e.g., regression, classification).\n(Inspired by metamorph.ml.design-matrix but adapted for columnwise computation.)\n\nExamples\n\n(tm/design (tc/dataset {\"w\" [:A :B :C]\n                        :x (range 3)\n                        :y (reverse (range 3))})\n           [:y]\n           [\"w\"\n            :x\n            '(tcc/+ x y)\n            [:z '(tcc/+ x y)]\n            [:z1000 '(tcc/* z 1000)]\n            '((juxt tcc/+ tcc/*) x y)\n            [:p '((juxt tcc/+ tcc/*) x y)]\n            '{:a (tcc/+ x y)\n              :b (tcc/* x y)}\n            [:p '{:a (tcc/+ x y)\n                  :b (tcc/* x y)}]\n            '[(tcc/column (tcc/+ x y)\n                          {:name :c})\n              (tcc/column (tcc/* x y)\n                          {:name :d})]\n            [:p '[(tcc/column (tcc/+ x y)\n                              {:name :c})\n                  (tcc/column (tcc/* x y)\n                              {:name :d})]]])\n\n\n_unnamed [3 18]:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n:y\nw\n:x\n(tcc/+ x y)\n:z\n:z1000\n((juxt tcc/+ tcc/*) x y)_0\n((juxt tcc/+ tcc/*) x y)_1\n:p_0\n:p_1\n:a\n:b\n:pa\n:pb\n:c\n:d\n:pc\n:pd\n\n\n\n\n2\n:A\n0\n2\n2\n2000\n2\n0\n2\n0\n2\n0\n2\n0\n2\n0\n2\n0\n\n\n1\n:B\n1\n2\n2\n2000\n2\n1\n2\n1\n2\n1\n2\n1\n2\n1\n2\n1\n\n\n0\n:C\n2\n2\n2\n2000\n2\n0\n2\n0\n2\n0\n2\n0\n2\n0\n2\n0\n\n\n\n\n\n\n\npolynomial\n[column degree]\nGiven a column and an integer degree, return a vector of columns with all its powers up to that degree, named appropriately.\n\nExamples\n\n(-&gt; [1 2 3]\n    (tcc/column {:name :x})\n    (tm/polynomial 4))\n\n\n[#tech.v3.dataset.column&lt;int64&gt;[3]\n:x\n[1, 2, 3] #tech.v3.dataset.column&lt;int64&gt;[3]\n:x2\n[1, 4, 9] #tech.v3.dataset.column&lt;int64&gt;[3]\n:x3\n[1, 8, 27] #tech.v3.dataset.column&lt;int64&gt;[3]\n:x4\n[1, 16, 81]]\n\n\n\n\none-hot\n[column]\n[column {:keys [values include-last], :or {values (distinct column), include-last false}}]\nGiven a column, create a vector of integer binary columns, each encoding the presence of absence of one of its values.\nE.g., if the column name is :x, and one of the values is :A, then a resulting binary column will have 1 in all the rows where column has :A.\nThe sequence of values to generate the binary columns is defined as follows: either the value provided for the :values key if present, or the distinct values in column in their order of appearance. If the value of the option key :include-last is false (which is the default), then the last value is ommitted. This is handy for avoiding multicollinearity in linear regression.\nSupported options: - :values - the values to encode as columns - default nil - :include-last - should the last value be included - default false\n\nExamples\n\n(tm/one-hot (tcc/column [:B :A :A :B :B :C]\n                        {:name :x}))\n\n\n[#tech.v3.dataset.column&lt;int64&gt;[6]\n:x=:B\n[1, 0, 0, 1, 1, 0] #tech.v3.dataset.column&lt;int64&gt;[6]\n:x=:A\n[0, 1, 1, 0, 0, 0]]\n\n\n(tm/one-hot (tcc/column [:B :A :A :B :B :C]\n                        {:name :x})\n            {:values [:A :B :C]})\n\n\n[#tech.v3.dataset.column&lt;int64&gt;[6]\n:x=:A\n[0, 1, 1, 0, 0, 0] #tech.v3.dataset.column&lt;int64&gt;[6]\n:x=:B\n[1, 0, 0, 1, 1, 0]]\n\n\n(tm/one-hot (tcc/column [:B :A :A :B :B :C]\n                        {:name :x})\n            {:values [:A :B :C]\n             :include-last true})\n\n\n[#tech.v3.dataset.column&lt;int64&gt;[6]\n:x=:A\n[0, 1, 1, 0, 0, 0] #tech.v3.dataset.column&lt;int64&gt;[6]\n:x=:B\n[1, 0, 0, 1, 1, 0] #tech.v3.dataset.column&lt;int64&gt;[6]\n:x=:C\n[0, 0, 0, 0, 0, 1]]\n\n\n\n\nlm\n[dataset]\n[dataset options]\nCompute a linear regression model for dataset. The first column marked as target is the target. All the columns unmarked as target are the features. The resulting model is of type fastmath.ml.regression.LMData, a generated by Fastmath. It can be summarized by summary.\nSee fastmath.ml.regression.lm for options.\n\nExamples:\n\nLinear relationship\n\n(def linear-toydata\n  (-&gt; {:x (range 9)}\n      tc/dataset\n      (tc/map-columns :y\n                      [:x]\n                      (fn [x]\n                        (+ (* 2 x)\n                           -3\n                           (* 3 (rand)))))))\n\n\n(-&gt; linear-toydata\n    plotly/layer-point)\n\n\nNote how the coefficients fit the way we generated the data:\n\n(-&gt; linear-toydata\n    (tm/design [:y]\n               [:x])\n    tm/lm\n    tm/summary)\n\n\nResiduals:\n\n|      :min |       :q1 |  :median |      :q3 |     :max |\n|-----------+-----------+----------+----------+----------|\n| -1.112596 | -1.018804 | 0.033899 | 0.992519 | 1.331589 |\n\nCoefficients:\n\n|     :name | :estimate |  :stderr |  :t-value | :p-value | :confidence-interval |\n|-----------+-----------+----------+-----------+----------+----------------------|\n| Intercept | -0.964159 |  0.65805 | -1.465177 | 0.186293 | [-2.520199 0.591881] |\n|        :x |  1.918419 | 0.138218 | 13.879659 |   2.0E-6 |  [1.591586 2.245253] |\n\nF-statistic: 192.64492536036985 on degrees of freedom: {:residual 7, :model 1, :intercept 1}\np-value: 2.3816713911051224E-6\n\nR2: 0.9649377514236106\nAdjusted R2: 0.9599288587698407\nResidual standard error: 1.07063246079246 on 7 degrees of freedom\nAIC: 30.50755579984122\n\n\n\n\nCubic relationship\n\n(def cubic-toydata\n  (-&gt; {:x (range 9)}\n      tc/dataset\n      (tc/map-columns :y\n                      [:x]\n                      (fn [x]\n                        (+ 50\n                           (* 4 x)\n                           (* -9 x x)\n                           (* x x x)\n                           (* 10 (rand)))))))\n\n\n(-&gt; cubic-toydata\n    plotly/layer-point)\n\n\nNote how the coefficients fit the way we generated the data:\n\n(-&gt; cubic-toydata\n    (tm/design [:y]\n               ['(tm/polynomial x 3)])\n    tm/lm\n    tm/summary)\n\n\nResiduals:\n\n|     :min |       :q1 |   :median |      :q3 |     :max |\n|----------+-----------+-----------+----------+----------|\n| -4.46192 | -1.251405 | -0.588872 | 2.680837 | 3.474228 |\n\nCoefficients:\n\n|     :name | :estimate |  :stderr |  :t-value | :p-value |   :confidence-interval |\n|-----------+-----------+----------+-----------+----------+------------------------|\n| Intercept | 54.035832 | 2.959708 | 18.257151 |   9.0E-6 |   [46.42766 61.644003] |\n|        :x |  5.516304 |  3.41593 |  1.614876 | 0.167259 |  [-3.264624 14.297233] |\n|       :x2 | -9.303257 | 1.031358 | -9.020399 |   2.8E-4 | [-11.954446 -6.652068] |\n|       :x3 |  1.016625 | 0.084598 |  12.01718 |   7.0E-5 |      [0.79916 1.23409] |\n\nF-statistic: 261.654706742745 on degrees of freedom: {:residual 5, :model 3, :intercept 1}\np-value: 6.478174587432051E-6\n\nR2: 0.9936705986107883\nAdjusted R2: 0.9898729577772614\nResidual standard error: 3.1941622811238553 on 5 degrees of freedom\nAIC: 51.15466103269903\n\n\n\n\nCategorical relationship\n\n(def days-of-week\n  [:Mon :Tue :Wed :Thu :Fri :Sat :Sun])\n\n\n(def categorical-toydata\n  (-&gt; {:t (range 21)\n       :day-of-week (-&gt;&gt; days-of-week\n                         (repeat 3)\n                         (apply concat)\n                         (drop 3))}\n      tc/dataset\n      (tc/map-columns :traffic\n                      [:day-of-week]\n                      (fn [dow]\n                        (+ (case dow\n                             :Sat 50\n                             :Sun 50\n                             60)\n                           (* 5 (rand)))))))\n\n\n(-&gt; categorical-toydata\n    (plotly/layer-point {:=x :t\n                         :=y :traffic\n                         :=color :day-of-week\n                         :=mark-size 10})\n    (plotly/layer-line {:=x :t\n                        :=y :traffic}))\n\n\nA model with all days except for one, dropping one category to avoid multicolinearity (note we begin with Thursday due to the order of appearance):\n\n(-&gt; categorical-toydata\n    (tm/design [:traffic]\n               ['(tm/one-hot day-of-week)])\n    tm/lm\n    tm/summary)\n\n\nResiduals:\n\n|      :min |       :q1 |   :median |      :q3 |     :max |\n|-----------+-----------+-----------+----------+----------|\n| -1.868088 | -1.234805 | -0.350261 | 1.130497 | 2.551595 |\n\nCoefficients:\n\n|             :name | :estimate |  :stderr |  :t-value | :p-value |   :confidence-interval |\n|-------------------+-----------+----------+-----------+----------+------------------------|\n|         Intercept |  61.55921 |   0.9472 | 64.990704 |      0.0 |  [59.512909 63.605512] |\n| :day-of-week=:Thu |  0.494675 | 1.339543 |  0.369286 |  0.71786 |   [-2.399233 3.388582] |\n| :day-of-week=:Fri |  0.677621 | 1.339543 |   0.50586 | 0.621424 |   [-2.216286 3.571529] |\n| :day-of-week=:Sat | -9.970723 | 1.339543 | -7.443374 |   5.0E-6 | [-12.864631 -7.076816] |\n| :day-of-week=:Sun | -9.612128 | 1.339543 | -7.175675 |   7.0E-6 |  [-12.506035 -6.71822] |\n| :day-of-week=:Mon |  0.732698 | 1.497655 |   0.48923 |  0.63283 |   [-2.502789 3.968185] |\n| :day-of-week=:Tue | -0.146058 | 1.497655 | -0.097525 | 0.923797 |   [-3.381545 3.089429] |\n| :day-of-week=:Wed |  0.597514 | 1.497655 |  0.398967 | 0.696394 |   [-2.637973 3.833001] |\n\nF-statistic: 23.687437499366894 on degrees of freedom: {:residual 13, :model 7, :intercept 1}\np-value: 1.9747517513435398E-6\n\nR2: 0.9272979696192353\nAdjusted R2: 0.8881507224911311\nResidual standard error: 1.6405989318486354 on 13 degrees of freedom\nAIC: 88.31696156462964\n\n\nA model with all days except for one, dropping one category to avoid multicolinearity, and speciftying the order of encoded values:\n\n(-&gt; categorical-toydata\n    (tm/design [:traffic]\n               ['(tm/one-hot day-of-week\n                             {:values days-of-week})])\n    tm/lm\n    tm/summary)\n\n\nResiduals:\n\n|      :min |       :q1 |   :median |      :q3 |     :max |\n|-----------+-----------+-----------+----------+----------|\n| -5.156325 | -1.383976 | -0.622956 | 1.668952 | 6.806543 |\n\nCoefficients:\n\n|             :name | :estimate |  :stderr |  :t-value | :p-value |  :confidence-interval |\n|-------------------+-----------+----------+-----------+----------+-----------------------|\n|         Intercept | 56.753147 | 1.437507 | 39.480254 |      0.0 |     [53.67 59.836293] |\n| :day-of-week=:Mon |  5.538762 | 2.875014 |  1.926516 | 0.074588 | [-0.627531 11.705054] |\n| :day-of-week=:Tue |  4.660006 | 2.875014 |  1.620864 | 0.127345 | [-1.506287 10.826298] |\n| :day-of-week=:Wed |  5.403578 | 2.875014 |  1.879496 | 0.081152 |  [-0.762714 11.56987] |\n| :day-of-week=:Thu |  5.300739 | 2.489835 |  2.128951 | 0.051494 | [-0.039427 10.640904] |\n| :day-of-week=:Fri |  5.483685 | 2.489835 |  2.202429 | 0.044895 |  [0.143519 10.823851] |\n| :day-of-week=:Sat | -5.164659 | 2.489835 | -2.074298 | 0.056974 | [-10.504825 0.175506] |\n\nF-statistic: 4.136292370106478 on degrees of freedom: {:residual 14, :model 6, :intercept 1}\np-value: 0.013430676507271366\n\nR2: 0.639340289486495\nAdjusted R2: 0.4847718421235643\nResidual standard error: 3.5211589305922124 on 14 degrees of freedom\nAIC: 119.94983856115492\n\n\nA model with all days and no intercept, dropping the intercept to avoid multicolinearity and have an easier interpretation of the coefficients:\nNote how the coefficients fit the way we generated the data:\n\n(-&gt; categorical-toydata\n    (tm/design [:traffic]\n               ['(tm/one-hot day-of-week\n                             {:values days-of-week\n                              :include-last true})])\n    (tm/lm {:intercept? false})\n    tm/summary)\n\n\nResiduals:\n\n|      :min |       :q1 |  :median |      :q3 |      :max |\n|-----------+-----------+----------+----------+-----------|\n| -1.868088 | -1.206448 | 0.411365 | 1.668952 | 63.559689 |\n\nCoefficients:\n\n|             :name | :estimate |   :stderr | :t-value | :p-value |   :confidence-interval |\n|-------------------+-----------+-----------+----------+----------+------------------------|\n| :day-of-week=:Mon | 62.291908 | 20.180967 | 3.086666 | 0.008043 |  [19.00804 105.575777] |\n| :day-of-week=:Tue | 61.413152 | 20.180967 | 3.043122 | 0.008769 | [18.129284 104.697021] |\n| :day-of-week=:Wed | 62.156725 | 20.180967 | 3.079968 |  0.00815 | [18.872856 105.440593] |\n| :day-of-week=:Thu | 62.053885 |  16.47769 | 3.765933 | 0.002087 |  [26.712755 97.395016] |\n| :day-of-week=:Fri | 62.236832 |  16.47769 | 3.777036 | 0.002041 |  [26.895701 97.577962] |\n| :day-of-week=:Sat | 51.588487 |  16.47769 | 3.130808 | 0.007367 |  [16.247357 86.929618] |\n| :day-of-week=:Sun | 51.947083 |  16.47769 | 3.152571 | 0.007055 |  [16.605952 87.288213] |\n\nF-statistic: 10.923317487831053 on degrees of freedom: {:residual 14, :model 7, :intercept 0}\np-value: 1.0005997960205182E-4\n\nR2: 0.8452409760974104\nAdjusted R2: 0.7678614641461157\nResidual standard error: 28.54019658104785 on 14 degrees of freedom\nAIC: 207.83581812173543\n\n\n\nsource: notebooks/tablemath_book/reference.clj",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>API reference</span>"
    ]
  }
]