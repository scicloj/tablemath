[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Tablemath",
    "section": "",
    "text": "1 Preface\nTablemath is a Clojure library for math and statistical modeling with table ergonomics, inspired by R.\nIt composes Tablecloth datasets with Fastmath modeling.",
    "crumbs": [
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>Preface</span>"
    ]
  },
  {
    "objectID": "index.html#general-info",
    "href": "index.html#general-info",
    "title": "Tablemath",
    "section": "General info",
    "text": "General info\n\n\n\nWebsite\nhttps://scicloj.github.io/tablemath/\n\n\nSource\n\n\n\nDeps\n\n\n\nLicense\nEPLv2.0\n\n\nStatus\nðŸ› experimentalðŸ› ",
    "crumbs": [
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>Preface</span>"
    ]
  },
  {
    "objectID": "index.html#chapters-in-this-book",
    "href": "index.html#chapters-in-this-book",
    "title": "Tablemath",
    "section": "Chapters in this book",
    "text": "Chapters in this book\n\nAPI reference\n\n\nsource: notebooks/index.clj",
    "crumbs": [
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>Preface</span>"
    ]
  },
  {
    "objectID": "tablemath_book.reference.html",
    "href": "tablemath_book.reference.html",
    "title": "2Â  API reference",
    "section": "",
    "text": "Setup\nIn this notebook, we will use Tablecloth and Tableplot for code examples, alongside Tablemath.",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>API reference</span>"
    ]
  },
  {
    "objectID": "tablemath_book.reference.html#setup",
    "href": "tablemath_book.reference.html#setup",
    "title": "2Â  API reference",
    "section": "",
    "text": "(ns tablemath-book.reference\n  (:require [scicloj.tablemath.v1.api :as tm]\n            [tablecloth.api :as tc]\n            [tablecloth.column.api :as tcc]\n            [scicloj.tableplot.v1.plotly :as plotly]\n            [tablemath-book.utils :as utils]))",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>API reference</span>"
    ]
  },
  {
    "objectID": "tablemath_book.reference.html#reference",
    "href": "tablemath_book.reference.html#reference",
    "title": "2Â  API reference",
    "section": "Reference",
    "text": "Reference\n\nwith\n[m expr]\nEvaluate expression expr in the context of destructuring all the keys of map m.\n\nExamples\n\n(tm/with {:x 3 :y 9}\n         '(+ x y))\n\n\n12\n\n\n(tm/with (tc/dataset {:x (range 4)\n                      :y 9})\n         '(tcc/+ x y))\n\n\n#tech.v3.dataset.column&lt;int64&gt;[4]\nnull\n[9, 10, 11, 12]\n\n\n\n\ncolumns-with\n[dataset specs]\nCompute a sequence of named columns by a given sequence of specs in the context of a given dataset.\nEach spec is one of the following:\n\n\na keyword or string - in that case, we just take the corresponding column of the original dataset.\n\n\na vector of two elements [nam expr], where the first is a string or a keyword. In that case, nam is interpreted as a name or a name-prefix for the resulting columns, and expr is handled as an expression as in (3).\n\n\nany other Clojure form - in that case, we treat it as an expression, and evaluate it while destructuring the column names of dataset as well as all the columns created by previous specs; the evaluation is expected to return one of the following:\n\n\na column (or the data to create a column (e.g., a vector of numbers))\na sequential of columns\na map from column names to columns\n\n\nIn any case, the result of the spec is turned into a sequence of named columns, which is conctenated to the columns from the previous specs. Some default naming mechanisms are invoked if column names are missing.\nEventually, the sequence of all resulting columns is returned.\n\nExamples\nNote the naming of the resulting columns, and note they can sequentially depend on each other.\n\n(tm/columns-with (tc/dataset {\"w\" [:A :B :C]\n                              :x (range 3)\n                              :y (reverse (range 3))})\n                 [\"w\"\n                  :x\n                  '(tcc/+ x y)\n                  [:z '(tcc/+ x y)]\n                  [:z1000 '(tcc/* z 1000)]\n                  '((juxt tcc/+ tcc/*) x y)\n                  [:p '((juxt tcc/+ tcc/*) x y)]\n                  '{:a (tcc/+ x y)\n                    :b (tcc/* x y)}\n                  [:p '{:a (tcc/+ x y)\n                        :b (tcc/* x y)}]\n                  '[(tcc/column (tcc/+ x y) {:name :c})\n                    (tcc/column (tcc/* x y) {:name :d})]\n                  [:p '[(tcc/column (tcc/+ x y) {:name :c})\n                        (tcc/column (tcc/* x y) {:name :d})]]])\n\n\n(#tech.v3.dataset.column&lt;keyword&gt;[3]\nw\n[:A, :B, :C] #tech.v3.dataset.column&lt;int64&gt;[3]\n:x\n[0, 1, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n(tcc/+ x y)\n[2, 2, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n:z\n[2, 2, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n:z1000\n[2000, 2000, 2000] #tech.v3.dataset.column&lt;int64&gt;[3]\n((juxt tcc/+ tcc/*) x y)_0\n[2, 2, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n((juxt tcc/+ tcc/*) x y)_1\n[0, 1, 0] #tech.v3.dataset.column&lt;int64&gt;[3]\n:p_0\n[2, 2, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n:p_1\n[0, 1, 0] #tech.v3.dataset.column&lt;int64&gt;[3]\n:a\n[2, 2, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n:b\n[0, 1, 0] #tech.v3.dataset.column&lt;int64&gt;[3]\n:pa\n[2, 2, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n:pb\n[0, 1, 0] #tech.v3.dataset.column&lt;int64&gt;[3]\n:c\n[2, 2, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n:d\n[0, 1, 0] #tech.v3.dataset.column&lt;int64&gt;[3]\n:pc\n[2, 2, 2] #tech.v3.dataset.column&lt;int64&gt;[3]\n:pd\n[0, 1, 0])\n\n\n\n\ndesign\n[dataset target-specs feature-specs]\nGiven a dataset and sequences target-specs, feature-specs, generate a new dataset from the columns generated by columns-with from these two sequences. The columns from target-specs will be marked as targets for modelling (e.g., regression, classification).\n(Inspired by metamorph.ml.design-matrix but adapted for columnwise computation.)\n\nExamples\n\n(tm/design (tc/dataset {\"w\" [:A :B :C]\n                        :x (range 3)\n                        :y (reverse (range 3))})\n           [:y]\n           [\"w\"\n            :x\n            '(tcc/+ x y)\n            [:z '(tcc/+ x y)]\n            [:z1000 '(tcc/* z 1000)]\n            '((juxt tcc/+ tcc/*) x y)\n            [:p '((juxt tcc/+ tcc/*) x y)]\n            '{:a (tcc/+ x y)\n              :b (tcc/* x y)}\n            [:p '{:a (tcc/+ x y)\n                  :b (tcc/* x y)}]\n            '[(tcc/column (tcc/+ x y)\n                          {:name :c})\n              (tcc/column (tcc/* x y)\n                          {:name :d})]\n            [:p '[(tcc/column (tcc/+ x y)\n                              {:name :c})\n                  (tcc/column (tcc/* x y)\n                              {:name :d})]]])\n\n\n_unnamed [3 18]:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n:y\nw\n:x\n(tcc/+ x y)\n:z\n:z1000\n((juxt tcc/+ tcc/*) x y)_0\n((juxt tcc/+ tcc/*) x y)_1\n:p_0\n:p_1\n:a\n:b\n:pa\n:pb\n:c\n:d\n:pc\n:pd\n\n\n\n\n2\n:A\n0\n2\n2\n2000\n2\n0\n2\n0\n2\n0\n2\n0\n2\n0\n2\n0\n\n\n1\n:B\n1\n2\n2\n2000\n2\n1\n2\n1\n2\n1\n2\n1\n2\n1\n2\n1\n\n\n0\n:C\n2\n2\n2\n2000\n2\n0\n2\n0\n2\n0\n2\n0\n2\n0\n2\n0\n\n\n\n\n\n\n\npolynomial\n[column degree]\nGiven a column and an integer degree, return a vector of columns with all its powers up to that degree, named appropriately.\n\nExamples\n\n(-&gt; [1 2 3]\n    (tcc/column {:name :x})\n    (tm/polynomial 4))\n\n\n[#tech.v3.dataset.column&lt;int64&gt;[3]\n:x\n[1, 2, 3] #tech.v3.dataset.column&lt;int64&gt;[3]\n:x2\n[1, 4, 9] #tech.v3.dataset.column&lt;int64&gt;[3]\n:x3\n[1, 8, 27] #tech.v3.dataset.column&lt;int64&gt;[3]\n:x4\n[1, 16, 81]]\n\n\n\n\none-hot\n[column]\n[column {:keys [values include-last], :or {values (distinct column), include-last false}}]\nGiven a column, create a vector of integer binary columns, each encoding the presence of absence of one of its values.\nE.g., if the column name is :x, and one of the values is :A, then a resulting binary column will have 1 in all the rows where column has :A.\nThe sequence of values to generate the binary columns is defined as follows: either the value provided for the :values key if present, or the distinct values in column in their order of appearance. If the value of the option key :include-last is false (which is the default), then the last value is ommitted. This is handy for avoiding multicollinearity in linear regression.\nSupported options: - :values - the values to encode as columns - default nil - :include-last - should the last value be included - default false\n\nExamples\n\n(tm/one-hot (tcc/column [:B :A :A :B :B :C]\n                        {:name :x}))\n\n\n[#tech.v3.dataset.column&lt;int64&gt;[6]\n:x=:B\n[1, 0, 0, 1, 1, 0] #tech.v3.dataset.column&lt;int64&gt;[6]\n:x=:A\n[0, 1, 1, 0, 0, 0]]\n\n\n(tm/one-hot (tcc/column [:B :A :A :B :B :C]\n                        {:name :x})\n            {:values [:A :B :C]})\n\n\n[#tech.v3.dataset.column&lt;int64&gt;[6]\n:x=:A\n[0, 1, 1, 0, 0, 0] #tech.v3.dataset.column&lt;int64&gt;[6]\n:x=:B\n[1, 0, 0, 1, 1, 0]]\n\n\n(tm/one-hot (tcc/column [:B :A :A :B :B :C]\n                        {:name :x})\n            {:values [:A :B :C]\n             :include-last true})\n\n\n[#tech.v3.dataset.column&lt;int64&gt;[6]\n:x=:A\n[0, 1, 1, 0, 0, 0] #tech.v3.dataset.column&lt;int64&gt;[6]\n:x=:B\n[1, 0, 0, 1, 1, 0] #tech.v3.dataset.column&lt;int64&gt;[6]\n:x=:C\n[0, 0, 0, 0, 0, 1]]\n\n\n\n\nlm\n[dataset]\n[dataset options]\nCompute a linear regression model for dataset. The first column marked as target is the target. All the columns unmarked as target are the features. The resulting model is of type fastmath.ml.regression.LMData, a generated by Fastmath. It can be summarized by summary.\nSee fastmath.ml.regression.lm for options.\n\nExamples:\n\nLinear relationship\n\n(def linear-toydata\n  (-&gt; {:x (range 9)}\n      tc/dataset\n      (tc/map-columns :y\n                      [:x]\n                      (fn [x]\n                        (+ (* 2 x)\n                           -3\n                           (* 3 (rand)))))))\n\n\n(-&gt; linear-toydata\n    plotly/layer-point)\n\n\nNote how the coefficients fit the way we generated the data:\n\n(-&gt; linear-toydata\n    (tm/design [:y]\n               [:x])\n    tm/lm\n    tm/summary)\n\n\nResiduals:\n\n|      :min |       :q1 |  :median |      :q3 |     :max |\n|-----------+-----------+----------+----------+----------|\n| -1.368905 | -0.861143 | 0.166645 | 0.756204 | 1.300869 |\n\nCoefficients:\n\n|     :name | :estimate |  :stderr |  :t-value | :p-value |  :confidence-interval |\n|-----------+-----------+----------+-----------+----------+-----------------------|\n| Intercept | -1.538249 | 0.612071 | -2.513188 | 0.040209 | [-2.985566 -0.090932] |\n|        :x |    2.0943 | 0.128561 | 16.290374 |   1.0E-6 |   [1.790302 2.398297] |\n\nF-statistic: 265.37627410003336 on degrees of freedom: {:residual 7, :model 1, :intercept 1}\np-value: 7.999644764389302E-7\n\nR2: 0.9743002578946022\nAdjusted R2: 0.9706288661652597\nResidual standard error: 0.9958258484709785 on 7 degrees of freedom\nAIC: 29.203771766022996\n\n\n\n\nCubic relationship\n\n(def cubic-toydata\n  (-&gt; {:x (range 9)}\n      tc/dataset\n      (tc/map-columns :y\n                      [:x]\n                      (fn [x]\n                        (+ 50\n                           (* 4 x)\n                           (* -9 x x)\n                           (* x x x)\n                           (* 10 (rand)))))))\n\n\n(-&gt; cubic-toydata\n    plotly/layer-point)\n\n\nNote how the coefficients fit the way we generated the data:\n\n(-&gt; cubic-toydata\n    (tm/design [:y]\n               ['(tm/polynomial x 3)])\n    tm/lm\n    tm/summary)\n\n\nResiduals:\n\n|     :min |       :q1 |   :median |      :q3 |     :max |\n|----------+-----------+-----------+----------+----------|\n| -2.44235 | -0.989378 | -0.005178 | 1.338093 | 1.814442 |\n\nCoefficients:\n\n|     :name | :estimate |  :stderr |   :t-value | :p-value |   :confidence-interval |\n|-----------+-----------+----------+------------+----------+------------------------|\n| Intercept | 55.293656 | 1.625722 |  34.011757 |      0.0 |  [51.114605 59.472707] |\n|        :x |  4.165365 | 1.876318 |   2.219968 | 0.077131 |   [-0.657864 8.988593] |\n|       :x2 | -9.064755 | 0.566509 | -16.001083 |   1.7E-5 | [-10.521012 -7.608498] |\n|       :x3 |   1.00047 | 0.046468 |   21.53023 |   4.0E-6 |     [0.88102 1.119921] |\n\nF-statistic: 915.1047291904271 on degrees of freedom: {:residual 5, :model 3, :intercept 1}\np-value: 2.86891162715186E-7\n\nR2: 0.9981820258854079\nAdjusted R2: 0.9970912414166527\nResidual standard error: 1.754504054818821 on 5 degrees of freedom\nAIC: 40.37016570199448\n\n\n\n\nCategorical relationship\n\n(def days-of-week\n  [:Mon :Tue :Wed :Thu :Fri :Sat :Sun])\n\n\n(def categorical-toydata\n  (-&gt; {:t (range 21)\n       :day-of-week (-&gt;&gt; days-of-week\n                         (repeat 3)\n                         (apply concat)\n                         (drop 3))}\n      tc/dataset\n      (tc/map-columns :traffic\n                      [:day-of-week]\n                      (fn [dow]\n                        (+ (case dow\n                             :Sat 50\n                             :Sun 50\n                             60)\n                           (* 5 (rand)))))))\n\n\n(-&gt; categorical-toydata\n    (plotly/layer-point {:=x :t\n                         :=y :traffic\n                         :=color :day-of-week\n                         :=mark-size 10})\n    (plotly/layer-line {:=x :t\n                        :=y :traffic}))\n\n\nA model with all days except for one, dropping one category to avoid multicolinearity (note we begin with Thursday due to the order of appearance):\n\n(-&gt; categorical-toydata\n    (tm/design [:traffic]\n               ['(tm/one-hot day-of-week)])\n    tm/lm\n    tm/summary)\n\n\nResiduals:\n\n|      :min |       :q1 |   :median |      :q3 |     :max |\n|-----------+-----------+-----------+----------+----------|\n| -1.961295 | -0.815524 | -0.292471 | 1.061911 | 2.390817 |\n\nCoefficients:\n\n|             :name |  :estimate |  :stderr |  :t-value | :p-value |   :confidence-interval |\n|-------------------+------------+----------+-----------+----------+------------------------|\n|         Intercept |  61.865991 | 0.956053 |  64.70982 |      0.0 |  [59.800565 63.931417] |\n| :day-of-week=:Thu |   0.892344 | 1.352063 |  0.659987 | 0.520785 |    [-2.02861 3.813297] |\n| :day-of-week=:Fri |   0.566153 | 1.352063 |  0.418733 | 0.682247 |   [-2.354801 3.487106] |\n| :day-of-week=:Sat | -10.656278 | 1.352063 | -7.881498 |   3.0E-6 | [-13.577232 -7.735324] |\n| :day-of-week=:Sun |  -9.426566 | 1.352063 | -6.971989 |   1.0E-5 | [-12.347519 -6.505612] |\n| :day-of-week=:Mon |   0.075719 | 1.511652 |   0.05009 | 0.960812 |   [-3.190007 3.341444] |\n| :day-of-week=:Tue |  -0.344939 | 1.511652 | -0.228187 | 0.823051 |   [-3.610664 2.920787] |\n| :day-of-week=:Wed |   0.705859 | 1.511652 |  0.466946 | 0.648268 |   [-2.559866 3.971585] |\n\nF-statistic: 24.37118021053251 on degrees of freedom: {:residual 13, :model 7, :intercept 1}\np-value: 1.6704908561981924E-6\n\nR2: 0.9291932293059307\nAdjusted R2: 0.8910665066245088\nResidual standard error: 1.6559316650031601 on 13 degrees of freedom\nAIC: 88.70766288980772\n\n\nA model with all days except for one, dropping one category to avoid multicolinearity, and speciftying the order of encoded values:\n\n(-&gt; categorical-toydata\n    (tm/design [:traffic]\n               ['(tm/one-hot day-of-week\n                             {:values days-of-week})])\n    tm/lm\n    tm/summary)\n\n\nResiduals:\n\n|      :min |       :q1 |   :median |      :q3 |     :max |\n|-----------+-----------+-----------+----------+----------|\n| -6.674578 | -1.203647 | -0.191458 | 1.387996 | 7.048119 |\n\nCoefficients:\n\n|             :name | :estimate |  :stderr |  :t-value | :p-value |   :confidence-interval |\n|-------------------+-----------+----------+-----------+----------+------------------------|\n|         Intercept | 57.152709 | 1.418155 | 40.300762 |      0.0 |   [54.11107 60.194348] |\n| :day-of-week=:Mon |  4.789001 | 2.836309 |  1.688462 | 0.113462 |  [-1.294277 10.872279] |\n| :day-of-week=:Tue |  4.368344 | 2.836309 |  1.540151 | 0.145817 |  [-1.714934 10.451622] |\n| :day-of-week=:Wed |  5.419142 | 2.836309 |  1.910632 |  0.07675 |   [-0.664136 11.50242] |\n| :day-of-week=:Thu |  5.605626 | 2.456316 |  2.282128 | 0.038636 |     [0.337353 10.8739] |\n| :day-of-week=:Fri |  5.279436 | 2.456316 |  2.149331 | 0.049579 |   [0.011162 10.547709] |\n| :day-of-week=:Sat | -5.942995 | 2.456316 | -2.419475 | 0.029738 | [-11.211268 -0.674722] |\n\nF-statistic: 4.6201715895605755 on degrees of freedom: {:residual 14, :model 6, :intercept 1}\np-value: 0.008629460026389202\n\nR2: 0.6644378109734268\nAdjusted R2: 0.5206254442477526\nResidual standard error: 3.473754998366949 on 14 degrees of freedom\nAIC: 119.38056904506934\n\n\nA model with all days and no intercept, dropping the intercept to avoid multicolinearity and have an easier interpretation of the coefficients:\nNote how the coefficients fit the way we generated the data:\n\n(-&gt; categorical-toydata\n    (tm/design [:traffic]\n               ['(tm/one-hot day-of-week\n                             {:values days-of-week\n                              :include-last true})])\n    (tm/lm {:intercept? false})\n    tm/summary)\n\n\nResiduals:\n\n|      :min |       :q1 |   :median |     :q3 |      :max |\n|-----------+-----------+-----------+---------+-----------|\n| -1.961295 | -0.736394 | -0.081753 | 1.94849 | 64.200827 |\n\nCoefficients:\n\n|             :name | :estimate |   :stderr | :t-value | :p-value |   :confidence-interval |\n|-------------------+-----------+-----------+----------+----------+------------------------|\n| :day-of-week=:Mon |  61.94171 | 20.281809 | 3.054052 | 0.008581 | [18.441555 105.441865] |\n| :day-of-week=:Tue | 61.521053 | 20.281809 | 3.033312 | 0.008941 | [18.020898 105.021207] |\n| :day-of-week=:Wed | 62.571851 | 20.281809 | 3.085122 | 0.008067 | [19.071696 106.072005] |\n| :day-of-week=:Thu | 62.758335 | 16.560028 | 3.789748 | 0.001991 |  [27.240608 98.276063] |\n| :day-of-week=:Fri | 62.432144 | 16.560028 | 3.770051 |  0.00207 |  [26.914417 97.949872] |\n| :day-of-week=:Sat | 51.209713 | 16.560028 | 3.092369 | 0.007952 |  [15.691986 86.727441] |\n| :day-of-week=:Sun | 52.439426 | 16.560028 | 3.166627 | 0.006861 |  [16.921698 87.957153] |\n\nF-statistic: 10.887419319252851 on degrees of freedom: {:residual 14, :model 7, :intercept 0}\np-value: 1.0191663237901771E-4\n\nR2: 0.84480989168932\nAdjusted R2: 0.76721483753398\nResidual standard error: 28.68280980538554 on 14 degrees of freedom\nAIC: 208.04516636125462\n\n\n\nsource: notebooks/tablemath_book/reference.clj",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>API reference</span>"
    ]
  }
]